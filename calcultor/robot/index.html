<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Estimate Cost</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="table-container">
    <h2 style="text-align: center;">Robot Estimate Cost</h2>
    <table border="1">
        <thead>
             <tr>
            <th>No</th>
            <th>Item</th>
            <th>Image</th>
            <th>Qty</th>
            <th>Unit Price</th>
            <th>Total Price</th>
        </tr>
        </thead>
       <tbody id="robotList">
       
       </tbody>
        <tfoot>
            <tr>
                <td colspan="5" style="text-align:left;"><strong>Grand Total:</strong></td>
                <td><span id="totalPrice">$0</span></td>
            </tr>
        </tfoot>
        
    </table>
    </div>
   
<button id="connectBtn">Click Me</button>
  <div id="result"></div>

 <script>
/*let clickCount = 0;

document.getElementById('connectBtn').onclick = function() {
  clickCount++;
  if (clickCount === 1) {
    // First click: show message from HTML only
    document.getElementById('result').innerText = "Your payment is successful. Thank You";
  } else if (clickCount === 2) {
    // Second click: fetch result from SQL via Flask API
    const data = {
      host: "localhost",
      dbName: "robotdb",
      port: 3306,
      username: "robotuser",
      password: "myrobotpassword",
      dbType: "mysql"
    };

    fetch('http://127.0.0.1:5500/databaseconnrequest', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
      if(result.status === 'success') {
        document.getElementById('result').innerText = "Robot Estimate Cost: " + result.estimate_cost;
      } else {
        document.getElementById('result').innerText = result.message;
      }
    })
    .catch(error => {
      document.getElementById('result').innerText = 'Error: ' + error;
    });
  }
}*/

let clickCount = 0;
document.getElementById('connectBtn').onclick = function() {
  clickCount++;
  if (clickCount === 1) {
    document.getElementById('result').innerText = "Your payment is successful. Thank You";
  } else if (clickCount === 2) {
    const data = {
      host: "localhost",
      dbName: "robotdb",
      port: 3306,
      username: "robotuser",
      password: "myrobotpassword",
      dbType: "mysql"
    };

    fetch('http://127.0.0.1:5000/databaseconnrequest', {  // <-- port 5000 for Flask
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
      if(result.status === 'success') {
        document.getElementById('result').innerText = "Robot Estimate Cost: " + result.estimate_cost;
      } else {
        document.getElementById('result').innerText = result.message;
      }
    })
    .catch(error => {
      document.getElementById('result').innerText = 'Error: ' + error;
    });
  }
}
</script>
   
   <script src="script.js"></script>
    
    
</body>
</html>